{% extends "admin/base.html" %} {% block title %}Contact Submissions - Admin{%
endblock %} {% block content %}
<div class="admin-header">
  <h1>Contact Submissions</h1>
  <p>View and manage customer inquiries</p>
</div>

<div class="admin-card">
  <div class="contacts-filters">
    <button class="filter-btn active" data-filter="all">
      All ({{ contacts|length }})
    </button>
    <button class="filter-btn" data-filter="unread">
      Unread ({{ contacts|selectattr('read', 'equalto', False)|list|length }})
    </button>
    <button class="filter-btn" data-filter="read">
      Read ({{ contacts|selectattr('read', 'equalto', True)|list|length }})
    </button>
  </div>

  {% if contacts %}
  <div class="contacts-list">
    {% for contact in contacts %}
    <div
      class="contact-item {% if not contact.read %}unread{% endif %}"
      data-status="{% if contact.read %}read{% else %}unread{% endif %}"
    >
      <div class="contact-header">
        <div class="contact-meta">
          <h3>
            {{ contact.first_name }} {{ contact.last_name if contact.last_name
            else '' }}
          </h3>
          <span class="contact-date"
            >{{ contact.created_at.strftime('%B %d, %Y at %I:%M %p') }}</span
          >
          {% if not contact.read %}
          <span class="badge-new">NEW</span>
          {% endif %}
        </div>
        <div class="contact-actions">
          {% if not contact.read %}
          <a
            href="{{ url_for('admin_contact_mark_read', id=contact.id) }}"
            class="btn-mark-read"
            title="Mark as read"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
          </a>
          {% endif %}
          <button
            class="btn-delete"
            onclick="deleteContact({{ contact.id }})"
            title="Delete"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="3 6 5 6 21 6"></polyline>
              <path
                d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
              ></path>
            </svg>
          </button>
        </div>
      </div>

      <div class="contact-details">
        <div class="contact-info-grid">
          <div class="info-item">
            <span class="info-label">Email:</span>
            <a href="mailto:{{ contact.email }}" class="info-value"
              >{{ contact.email }}</a
            >
          </div>
          <div class="info-item">
            <span class="info-label">Phone:</span>
            <a href="tel:{{ contact.phone }}" class="info-value"
              >{{ contact.phone }}</a
            >
          </div>
          {% if contact.issue %}
          <div class="info-item full-width">
            <span class="info-label">Issue:</span>
            <span class="info-value">{{ contact.issue }}</span>
          </div>
          {% endif %}
        </div>

        {% if contact.message %}
        <div class="contact-message">
          <span class="info-label">Message:</span>
          <p class="message-text">{{ contact.message }}</p>
        </div>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="empty-state">
    <svg
      width="64"
      height="64"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
    >
      <path
        d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
      />
    </svg>
    <h3>No Contact Submissions</h3>
    <p>Contact submissions will appear here when customers reach out.</p>
  </div>
  {% endif %}
</div>

<style>
  .admin-header {
    margin-bottom: 2rem;
  }

  .admin-header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  .admin-header p {
    color: #777e90;
  }

  .admin-card {
    background: #1a1a1d;
    border-radius: 12px;
    padding: 2rem;
  }

  .contacts-filters {
    display: flex;
    gap: 1rem;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .filter-btn {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #777e90;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.9rem;
  }

  .filter-btn:hover {
    border-color: rgba(0, 153, 255, 0.5);
    color: #0099ff;
  }

  .filter-btn.active {
    background: #0099ff;
    border-color: #0099ff;
    color: #fff;
  }

  .contacts-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .contact-item {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    padding: 1.5rem;
    transition: all 0.3s;
  }

  .contact-item.unread {
    background: rgba(0, 153, 255, 0.05);
    border-color: rgba(0, 153, 255, 0.2);
  }

  .contact-item:hover {
    border-color: rgba(0, 153, 255, 0.3);
  }

  .contact-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
  }

  .contact-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .contact-meta h3 {
    font-size: 1.125rem;
    color: #fff;
    margin: 0;
  }

  .contact-date {
    font-size: 0.875rem;
    color: #777e90;
  }

  .badge-new {
    background: #0099ff;
    color: #fff;
    padding: 0.25rem 0.75rem;
    border-radius: 6px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
  }

  .contact-actions {
    display: flex;
    gap: 0.5rem;
  }

  .btn-mark-read,
  .btn-delete {
    background: transparent;
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #777e90;
    padding: 0.5rem;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    text-decoration: none;
  }

  .btn-mark-read:hover {
    background: rgba(34, 197, 94, 0.1);
    border-color: rgba(34, 197, 94, 0.5);
    color: #22c55e;
  }

  .btn-delete:hover {
    background: rgba(239, 68, 68, 0.1);
    border-color: rgba(239, 68, 68, 0.5);
    color: #ef4444;
  }

  .contact-details {
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
  }

  .contact-info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 1rem;
  }

  .info-item.full-width {
    grid-column: 1 / -1;
  }

  .info-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .info-label {
    font-size: 0.75rem;
    color: #777e90;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 600;
  }

  .info-value {
    color: #fff;
    font-size: 0.95rem;
  }

  .info-value a {
    color: #0099ff;
    text-decoration: none;
  }

  .info-value a:hover {
    text-decoration: underline;
  }

  .contact-message {
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
  }

  .message-text {
    color: #b1b0b6;
    line-height: 1.6;
    margin-top: 0.5rem;
    white-space: pre-wrap;
  }

  .empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: #777e90;
  }

  .empty-state svg {
    margin-bottom: 1.5rem;
    opacity: 0.3;
  }

  .empty-state h3 {
    font-size: 1.25rem;
    color: #b1b0b6;
    margin-bottom: 0.5rem;
  }

  @media (max-width: 768px) {
    .contact-header {
      flex-direction: column;
      gap: 1rem;
    }

    .contact-actions {
      width: 100%;
      justify-content: flex-end;
    }

    .contact-info-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

<script>
  // Filter functionality
  const filterBtns = document.querySelectorAll(".filter-btn");
  const contactItems = document.querySelectorAll(".contact-item");

  filterBtns.forEach((btn) => {
    btn.addEventListener("click", () => {
      // Update active state
      filterBtns.forEach((b) => b.classList.remove("active"));
      btn.classList.add("active");

      const filter = btn.dataset.filter;

      // Filter contacts
      contactItems.forEach((item) => {
        if (filter === "all") {
          item.style.display = "block";
        } else {
          item.style.display =
            item.dataset.status === filter ? "block" : "none";
        }
      });
    });
  });

  // Delete contact
  function deleteContact(id) {
    if (confirm("Are you sure you want to delete this contact submission?")) {
      window.location.href = `/admin/contacts/delete/${id}`;
    }
  }
</script>
{% endblock %}
