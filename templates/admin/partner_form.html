{% extends 'admin/base.html' %} {% block title %}{% if partner %}Edit{% else
%}Add{% endif %} Partner{% endblock %} {% block page_title %}
<h2>{% if partner %}Edit Partner{% else %}Add Partner{% endif %}</h2>
<p>
  {% if partner %}Update partner details{% else %}Create a new partner{% endif
  %}
</p>
{% endblock %} {% block content %}
<div class="form-container">
  <form method="POST" enctype="multipart/form-data" class="admin-form">
    <!-- Partner Info -->
    <div class="form-section">
      <h3>Partner Information</h3>

      <div class="form-group">
        <label>Partner Name *</label>
        <input
          type="text"
          name="name"
          value="{{ partner.name if partner else '' }}"
          required
          maxlength="100"
          placeholder="e.g., Acme Corporation"
        />
        <small>Company or organization name</small>
      </div>

      <div class="form-group">
        <label>Website URL</label>
        <input
          type="url"
          name="website"
          value="{{ partner.website if partner else '' }}"
          placeholder="https://example.com"
        />
        <small>Partner's website (optional)</small>
      </div>

      <div class="form-group">
        <label>Logo Image *</label>
        <div class="file-upload-wrapper">
          <input
            type="file"
            name="logo"
            id="logo-upload"
            accept="image/png,image/jpeg,image/jpg,image/gif,image/webp,image/svg+xml"
            {%
            if
            not
            partner
            %}required{%
            endif
            %}
          />
          <label for="logo-upload" class="file-upload-label">
            <svg
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            <span id="file-name">Choose logo file</span>
          </label>
        </div>
        <small
          >Recommended: PNG or SVG format, transparent background, 200x100px
          minimum</small
        >

        {% if partner and partner.logo_path %}
        <div class="preview-image">
          <img
            src="{{ url_for('static', filename=partner.logo_path) }}"
            alt="{{ partner.name }}"
          />
          <small>Current logo</small>
        </div>
        {% endif %}
      </div>
    </div>

    <!-- Settings -->
    <div class="form-section">
      <h3>Display Settings</h3>

      <div class="form-group">
        <label>Display Order</label>
        <input
          type="number"
          name="order"
          value="{{ partner.order if partner else 0 }}"
          min="0"
          placeholder="0"
        />
        <small>Lower numbers appear first (0 = highest priority)</small>
      </div>

      <div class="form-group checkbox">
        <label>
          <input
            type="checkbox"
            name="active"
            {%
            if
            partner
            is
            none
            or
            partner.active
            %}checked{%
            endif
            %}
          />
          <span>Active - Show on website</span>
        </label>
        <small>Uncheck to hide this partner without deleting</small>
      </div>
    </div>

    <!-- Actions -->
    <div class="form-actions">
      <button type="submit" class="btn btn-primary">
        {% if partner %}Update Partner{% else %}Create Partner{% endif %}
      </button>
      <a href="{{ url_for('admin_partners') }}" class="btn btn-secondary"
        >Cancel</a
      >
      {% if partner %}
      <a
        href="{{ url_for('admin_partner_delete', id=partner.id) }}"
        class="btn btn-danger"
        onclick="return confirm('Are you sure you want to delete this partner? This action cannot be undone.')"
      >
        Delete Partner
      </a>
      {% endif %}
    </div>
  </form>
</div>

<style>
  .form-container {
    background: linear-gradient(
      158deg,
      rgba(42, 43, 46, 0.95) 27%,
      rgba(27, 28, 31, 0.95) 119%
    );
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 20px;
    padding: 2rem;
    max-width: 700px;
  }

  .form-section {
    margin-bottom: 2.5rem;
    padding-bottom: 2.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  }

  .form-section:last-of-type {
    border-bottom: none;
    margin-bottom: 1rem;
    padding-bottom: 1rem;
  }

  .form-section h3 {
    font-size: 1.1rem;
    font-weight: 600;
    color: #fff;
    margin-bottom: 1.5rem;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-group label {
    display: block;
    font-size: 0.9rem;
    font-weight: 500;
    color: #b1b0b6;
    margin-bottom: 0.5rem;
  }

  .form-group input[type="text"],
  .form-group input[type="url"],
  .form-group input[type="number"] {
    width: 100%;
    padding: 0.875rem;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: #fff;
    font-size: 0.9rem;
    font-family: inherit;
    transition: all 0.3s ease;
  }

  .form-group input:focus {
    outline: none;
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(0, 153, 255, 0.3);
    box-shadow: 0 0 0 3px rgba(0, 153, 255, 0.1);
  }

  .form-group input::placeholder {
    color: #777e90;
  }

  .form-group small {
    display: block;
    margin-top: 0.5rem;
    color: #777e90;
    font-size: 0.8rem;
  }

  .form-group.checkbox {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }

  .form-group.checkbox label {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0;
    cursor: pointer;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.03);
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .form-group.checkbox label:hover {
    background: rgba(255, 255, 255, 0.05);
  }

  .form-group.checkbox input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
  }

  .form-group.checkbox span {
    color: #fff;
  }

  /* File Upload Styling */
  .file-upload-wrapper {
    position: relative;
  }

  .file-upload-wrapper input[type="file"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .file-upload-label {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem 1.5rem;
    background: rgba(0, 153, 255, 0.1);
    border: 2px dashed rgba(0, 153, 255, 0.3);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-bottom: 0;
  }

  .file-upload-label:hover {
    background: rgba(0, 153, 255, 0.15);
    border-color: rgba(0, 153, 255, 0.5);
  }

  .file-upload-label svg {
    width: 24px;
    height: 24px;
    color: #0099ff;
  }

  .file-upload-label span {
    color: #0099ff;
    font-weight: 500;
  }

  .preview-image {
    margin-top: 1rem;
    padding: 1.5rem;
    background: rgba(0, 153, 255, 0.05);
    border: 1px solid rgba(0, 153, 255, 0.2);
    border-radius: 10px;
    text-align: center;
  }

  .preview-image img {
    max-width: 100%;
    max-height: 150px;
    object-fit: contain;
    margin-bottom: 0.75rem;
    background: rgba(255, 255, 255, 0.05);
    padding: 1rem;
    border-radius: 8px;
  }

  .preview-image small {
    display: block;
    color: #777e90;
    font-size: 0.8rem;
  }

  .form-actions {
    display: flex;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(255, 255, 255, 0.08);
    flex-wrap: wrap;
  }

  .btn {
    flex: 1;
    min-width: 150px;
    padding: 0.875rem 1.75rem;
    border-radius: 10px;
    font-size: 0.9rem;
    font-weight: 600;
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    text-decoration: none;
    text-align: center;
    display: inline-block;
  }

  .btn-primary {
    background: linear-gradient(135deg, #0099ff, #0561e2);
    color: #fff;
    box-shadow: 0 4px 15px rgba(0, 153, 255, 0.3);
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 153, 255, 0.4);
  }

  .btn-secondary {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #b1b0b6;
  }

  .btn-secondary:hover {
    background: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.2);
  }

  .btn-danger {
    background: rgba(239, 68, 68, 0.2);
    border: 1px solid rgba(239, 68, 68, 0.3);
    color: #fca5a5;
    flex: 0 0 auto;
  }

  .btn-danger:hover {
    background: rgba(239, 68, 68, 0.3);
    color: #fff;
  }

  @media (max-width: 768px) {
    .form-container {
      padding: 1.5rem;
    }

    .form-actions {
      flex-direction: column;
    }

    .btn {
      flex: 1 1 100%;
    }
  }
</style>

<script>
  // Display selected file name
  document.getElementById('logo-upload')?.addEventListener('change', function(e) {
    const fileName = e.target.files[0]?.name || 'Choose logo file';
    document.getElementById('file-name').textContent = fileName;

    // Preview image
    if (e.target.files[0]) {
      const reader = new FileReader();
      reader.onload = function(event) {
        const preview = document.querySelector('.preview-image');
        if (!preview) {
          const newPreview = document.createElement('div');
          newPreview.className = 'preview-image';
          newPreview.innerHTML = `
            <img src="${event.target.result}" alt="Preview" />
            <small>Preview - New logo</small>
          `;
          e.target.closest('.form-group').appendChild(newPreview);
        } else {
          preview.querySelector('img').src = event.target.result;
          preview.querySelector('small').textContent = 'Preview - New logo';
        }
      };
      reader.readAsDataURL(e.target.files[0]);
    }
  });

  // Form validation
  document.querySelector('form')?.addEventListener('submit', function(e) {
    const nameInput = document.querySelector('input[name="name"]');
    const logoInput = document.querySelector('input[name="logo"]');
    const isEdit = {{ 'true' if partner else 'false' }};

    if (!nameInput.value.trim()) {
      e.preventDefault();
      alert('Please enter a partner name');
      nameInput.focus();
      return;
    }

    if (!isEdit && !logoInput.files.length) {
      e.preventDefault();
      alert('Please select a logo file');
      logoInput.focus();
      return;
    }
  });
</script>
{% endblock %}
